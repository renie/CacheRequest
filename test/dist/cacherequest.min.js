var CacheRequest=function(){var a=function(a){return void 0!==a&&null!==a?a.ajax:void 0}(jQuery),b=function(){function b(a){c(a);var b=f();b?g():h(),m.d.promise()}function c(a){m.opt=a,m.d=new $.Deferred,d(),e()}function d(){m.hash=m.opt.url+""+(m.opt.data||"")+(m.opt.method||"-ANY")}function e(){m.stored=localStorage.getItem(m.hash),m.stored=JSON.parse(m.stored)||null}function f(){if(!m.stored)return!1;var a=m.stored[m.storageKeys.timeout],b=m.stored[m.storageKeys.lastcall];return Date.now()-b<a}function g(){m.opt.hasOwnProperty("success")?m.opt.success.call(m.opt.context,null,"CACHED",m.stored[m.storageKeys.response]):m.opt.hasOwnProperty("complete")&&m.opt.complete(m.opt.context,"CACHED",m.stored[m.storageKeys.response]),m.d.resolve()}function h(){m.originalSettings={s:m.opt.success,f:m.opt.error,c:m.opt.complete,ctx:m.opt.context},m.opt.success=i,m.opt.error=j,m.opt.complete=k,m.opt.context=m,a(m.opt)}function i(a,b,c){l(c),m.originalSettings.s?m.originalSettings.s.call(m.originalSettings.ctx,a,b,c):m.originalSettings.c&&m.originalSettings.c.call(m.originalSettings.ctx,c,b),m.d.resolve()}function j(a,b,c){m.originalSettings.e&&m.originalSettings.call(m.originalSettings.ctx,a,b,c),m.d.resolve()}function k(a,b){(0===a.status||"error"===b)&&(a=m.opt.useOldIfError&&m.stored?m.stored[m.storageKeys.response]:null),m.originalSettings.c?m.originalSettings.c.call(m.originalSettings.ctx,a,b):console.log('No "complete" callback, no connection and no cache available (or you don\'t want it).'),m.d.resolve()}function l(a){var b={};b[m.storageKeys.timeout]=m.opt.cacheTimeout||m.defaultTimeout,b[m.storageKeys.lastcall]=Date.now(),b[m.storageKeys.response]=a,localStorage.setItem(m.hash,JSON.stringify(b))}var m=this;return m.storageKeys={timeout:"TIMEOUT",lastcall:"LASTCALL",response:"RESPONSE"},m.defaultTimeout=3e5,{send:b}};return{send:function(a){var c=new b;return c.send(a)}}}();