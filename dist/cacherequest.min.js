var CacheRequest=function(){var a=function(){function a(a){b(a);var c=e();c?f():g(),l.d.promise()}function b(a){l.opt=a,l.d=new $.Deferred,c(),d()}function c(){l.hash=l.opt.url+""+(l.opt.data||"")+(l.opt.method||"-ANY")}function d(){l.stored=localStorage.getItem(l.hash),l.stored=JSON.parse(l.stored)||null}function e(){if(!l.stored)return!1;var a=l.stored[l.storageKeys.timeout],b=l.stored[l.storageKeys.lastcall];return Date.now()-b<a}function f(){l.opt.hasOwnProperty("success")?l.opt.success.call(l.opt.context,null,"CACHED",l.stored[l.storageKeys.response]):l.opt.hasOwnProperty("complete")&&l.opt.complete(l.opt.context,"CACHED",l.stored[l.storageKeys.response]),l.d.resolve()}function g(){l.originalSettings={s:l.opt.success,f:l.opt.error,c:l.opt.complete,ctx:l.opt.context},l.opt.success=h,l.opt.error=i,l.opt.complete=j,l.opt.context=l,$.ajax(l.opt)}function h(a,b,c){k(c),l.originalSettings.s?l.originalSettings.s.call(l.originalSettings.ctx,a,b,c):l.originalSettings.c&&l.originalSettings.c.call(l.originalSettings.ctx,c,b),l.d.resolve()}function i(a,b,c){l.originalSettings.e&&l.originalSettings.call(l.originalSettings.ctx,a,b,c),l.d.resolve()}function j(a,b){(0===a.status||"error"===b)&&(a=l.opt.useOldIfError&&l.stored?l.stored[l.storageKeys.response]:null),l.originalSettings.c?l.originalSettings.c.call(l.originalSettings.ctx,a,b):console.log('No "complete" callback, no connection and no cache available (or you don\'t want it).'),l.d.resolve()}function k(a){var b={};b[l.storageKeys.timeout]=l.opt.cacheTimeout||l.defaultTimeout,b[l.storageKeys.lastcall]=Date.now(),b[l.storageKeys.response]=a,localStorage.setItem(l.hash,JSON.stringify(b))}var l=this;return l.storageKeys={timeout:"TIMEOUT",lastcall:"LASTCALL",response:"RESPONSE"},l.defaultTimeout=3e5,{send:a}};return{send:function(b){var c=new a;return c.send(b)}}}();